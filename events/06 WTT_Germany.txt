add_namespace = wtt_germany
# Event asking whether HUN/ROM want to become puppet in return for factories.
country_event = {
	id = wtt_germany.72
	title = wtt_germany.72.t
	desc = wtt_germany.72.desc
	picture = GFX_report_event_generic_read_write
	is_triggered_only = yes
	option = {
		# Yaplx
		name = wtt_germany.72.a
		set_country_flag = GER_Accept_economic_integration
		effect_tooltip = {
			GER = {
				random_owned_controlled_state = {
					limit = {
						free_building_slots = {
							building = arms_factory
							size > 1
							include_locked = yes
						}
						NOT = {
							has_state_flag = GER_integrate_war_economies
						}
					}
					add_extra_state_shared_building_slots = 2
					add_building_construction = {
						type = arms_factory
						level = 2
						instant_build = yes
					}
					set_state_flag = GER_integrate_war_economies
				}
				random_owned_controlled_state = {
					limit = {
						free_building_slots = {
							building = arms_factory
							size > 1
							include_locked = yes
						}
						NOT = {
							has_state_flag = GER_integrate_war_economies
						}
					}
					add_extra_state_shared_building_slots = 2
					add_building_construction = {
						type = arms_factory
						level = 2
						instant_build = yes
					}
					set_state_flag = GER_integrate_war_economies
				}
			}
			random_owned_controlled_state = {
				limit = {
					free_building_slots = {
						building = arms_factory
						size > 1
						include_locked = yes
					}
				}
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = arms_factory
					level = 2
					instant_build = yes
				}
				set_state_flag = GER_integrate_war_economies_1
			}
			random_owned_controlled_state = {
				limit = {
					free_building_slots = {
						building = arms_factory
						size > 1
						include_locked = yes
					}
				}
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = arms_factory
					level = 2
					instant_build = yes
				}
				set_state_flag = GER_integrate_war_economies_2
			}
			if = {
				limit = {
					has_dlc = "Death or Dishonor"
					is_in_faction_with = FROM
					FROM = {
						is_subject = no
					}
				}
				FROM = {
					set_autonomy = {
						target = ROOT
						autonomy_state = autonomy_satellite
					}
				}
			}
			if = {
				limit = {
					has_dlc = "Together for Victory"
					NOT = {
						has_dlc = "Death or Dishonor"
					}
					is_in_faction_with = FROM
					FROM = {
						is_subject = no
					}
				}
				FROM = {
					set_autonomy = {
						target = ROOT
						autonomy_state = autonomy_dominion
					}
				}
			}
			if = {
				limit = {
					NOT = {
						has_dlc = "Together for Victory"
					}
					NOT = {
						has_dlc = "Death or Dishonor"
					}
					is_in_faction_with = FROM
					FROM = {
						is_subject = no
					}
				}
				FROM = {
					puppet = ROOT
				}
			}
		}
		custom_effect_tooltip = wtt_germany.72_tt
		FROM = {
			country_event = {
				id = wtt_germany.73
				days = 1
			}
		}
	}
	option = {
		# Hell naw
		name = wtt_germany.72.b
		ai_chance = {
			base= 0
		}
		FROM = {
			country_event = {
				id = wtt_germany.74
				days = 1
			}
		}
	}
}

# Event for GER saying HUN/ROM accepted
country_event = {
	id = wtt_germany.73
	title = wtt_germany.73.t
	desc = wtt_germany.73.desc
	picture = GFX_report_event_generic_read_write
	is_triggered_only = yes
	option = {
		name = wtt_germany.73.a
		random_owned_controlled_state = {
			limit = {
				free_building_slots = {
					building = arms_factory
					size > 1
					include_locked = yes
				}
				NOT = {
					has_state_flag = GER_integrate_war_economies
				}
			}
			add_extra_state_shared_building_slots = 2
			add_building_construction = {
				type = arms_factory
				level = 2
				instant_build = yes
			}
			set_state_flag = GER_integrate_war_economies
		}
		random_owned_controlled_state = {
			limit = {
				free_building_slots = {
					building = arms_factory
					size > 1
					include_locked = yes
				}
				NOT = {
					has_state_flag = GER_integrate_war_economies
				}
			}
			add_extra_state_shared_building_slots = 2
			add_building_construction = {
				type = arms_factory
				level = 2
				instant_build = yes
			}
			set_state_flag = GER_integrate_war_economies
		}
		FROM = {
			random_owned_controlled_state = {
				limit = {
					free_building_slots = {
						building = arms_factory
						size > 1
						include_locked = yes
					}
				}
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = arms_factory
					level = 2
					instant_build = yes
				}
				set_state_flag = GER_integrate_war_economies_1
			}
			random_owned_controlled_state = {
				limit = {
					free_building_slots = {
						building = arms_factory
						size > 1
						include_locked = yes
					}
				}
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = arms_factory
					level = 2
					instant_build = yes
				}
				set_state_flag = GER_integrate_war_economies_2
			}
		}
		if = {
			limit = {
				has_dlc = "Death or Dishonor"
				is_subject = no
			}
			every_country = {
				limit = {
					is_subject_of = FROM
				}
				ROOT = {
					set_autonomy = {
						target = PREV
						autonomy_state = autonomy_satellite
					}
				}
			}
			set_autonomy = {
				target = FROM
				autonomy_state = autonomy_satellite
			}
		}
		if = {
			limit = {
				has_dlc = "Together for Victory"
				NOT = {
					has_dlc = "Death or Dishonor"
				}
				is_subject = no
			}
			every_country = {
				limit = {
					is_subject_of = FROM
				}
				ROOT = {
					set_autonomy = {
						target = PREV
						autonomy_state = autonomy_dominion
					}
				}
			}
			set_autonomy = {
				target = FROM
				autonomy_state = autonomy_dominion
			}
		}
		if = {
			limit = {
				NOT = {
					has_dlc = "Together for Victory"
				}
				NOT = {
					has_dlc = "Death or Dishonor"
				}
				is_subject = no
			}
			every_country = {
				limit = {
					is_subject_of = FROM
				}
				ROOT = {
					puppet = PREV
				}
			}
			puppet = FROM
		}
	}
}

# Event for GER saying HUN/ROM rejected
country_event = {
	id = wtt_germany.74
	title = wtt_germany.74.t
	desc = wtt_germany.74.desc
	picture = GFX_report_event_generic_read_write
	is_triggered_only = yes
	option = {
		name = wtt_germany.74.a
	}
}
