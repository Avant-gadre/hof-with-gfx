on_actions = {
	##罗胸/苏德/俄德战
	on_declare_war = {
		effect = {
			if = {
				limit = {
					tag = ROM
				}
				if = {
					limit = {
						date > 1936.10.1
						FROM = {
							tag = HUN
						}
						NOT = {
							has_global_flag = News_Third_Transylva_ian_War_flag
						}
					}
					hidden_effect = {
						set_global_flag = News_Third_Transylva_ian_War_flag
						news_event = {
							id = more_News.61
							days = 1
						}
					}
				}
			}
			if = {
				limit = {
					tag = HUN
				}
				if = {
					limit = {
						date > 1936.10.1
						FROM = {
							tag = ROM
						}
						NOT = {
							has_global_flag = News_Third_Transylva_ian_War_flag
						}
					}
					hidden_effect = {
						set_global_flag = News_Third_Transylva_ian_War_flag
						news_event = {
							id = more_News.61
							days = 1
						}
					}
				}
			}
			if = {
				limit = {
					tag = RUS
				}
				if = {
					limit = {
						FROM = {
							tag = GER
						}
						NOT = {
							has_global_flag = News_Thunderstorm_for_RUS_flag
						}
					}
					hidden_effect = {
						set_global_flag = News_Thunderstorm_for_RUS_flag
						news_event = {
							id = more_News.60
							days = 1
						}
					}
				}
			}
			if = {
				limit = {
					tag = SOV
				}
				if = {
					limit = {
						FROM = {
							tag = GER
						}
						NOT = {
							has_global_flag = News_Thunderstorm_for_SOV_flag
						}
					}
					hidden_effect = {
						set_global_flag = News_Thunderstorm_for_SOV_flag
						news_event = {
							id = more_News.59
							days = 1
						}
					}
				}
			}
			if = {
				limit = {
					tag = GER
				}
				if = {
					limit = {
						FROM = {
							tag = SOV
						}
						NOT = {
							has_global_flag = News_Barbarossa_to_SOV_flag
						}
					}
					hidden_effect = {
						set_global_flag = News_Barbarossa_to_SOV_flag
						news_event = {
							id = more_News.57
							days = 1
						}
					}
				}
				if = {
					limit = {
						FROM = {
							tag = RUS
						}
						NOT = {
							has_global_flag = News_Barbarossa_to_RUS_flag
						}
					}
					hidden_effect = {
						set_global_flag = News_Barbarossa_to_RUS_flag
						news_event = {
							id = more_News.58
							days = 1
						}
					}
				}
			}
		}
	}
	on_declare_war = {
		effect = {
			if = {
				limit = {
					has_global_flag = UKR_still_on_earth_flag
					FROM = {
						tag = UKR
					}
					ROOT = {
						OR = {
							tag = SOV
							tag = RUS
						}
					}
				}
				UKR = {
					add_timed_idea = {
						idea = UKR_great_patriotic_war
						days = 432
					}
				}
			}
			if = {
				limit = {
					FROM = {
						original_tag = FRA
					}
					tag = GER
				}
				set_country_flag = invalid_for_danzig_achievement
			}
			#make sure warlords don't use the same guy
			if = {
				limit = {
					tag = GER
					FROM = {
						OR = {
							has_opinion_modifier = anti_comintern_pact_opinion
							has_opinion_modifier = tripartite_pact_opinion
							has_idea = anti_soviet_pact
						}
					}
				}
				FROM = {
					remove_opinion_modifier = {
						target = GER
						modifier = anti_comintern_pact_opinion
					}
					remove_opinion_modifier = {
						target = GER
						modifier = tripartite_pact_opinion
					}
					remove_ideas = anti_soviet_pact
				}
			}
			#Germany has started a war - allies should try to contain Germany
			if = {
				limit = {
					ROOT = {
						tag = GER
					}
					NOT = {
						has_global_flag = GER_has_started_war
					}
				}
				set_global_flag = GER_has_started_war
			}
			#Call Anti-Soviet pact members to war
			if = {
				limit = {
					ROOT = {
						tag = SOV
					}
					FROM = {
						has_idea = anti_soviet_pact
					}
				}
				FROM = {
					country_event = {
						id = germany.84
						days = 1
					}
				}
			}
			#Remove MEFO bills if Germany goes to war
			if = {
				limit = {
					ROOT = {
						original_tag = GER
					}
					ROOT = {
						GER_has_mefo_bills = yes
					}
					NOT = {
						FROM = {
							original_tag = GER
						}
					}
					# Don't remove it from Fascist Germany if they start the civil war
				}
				ROOT = {
					GER_remove_mefo_bills = yes
					set_country_flag = mefo_bills_removed_through_war
				}
			}
			#Remove MEFO bills if Germany is declared war on
			if = {
				limit = {
					FROM = {
						original_tag = GER
					}
					FROM = {
						GER_has_mefo_bills = yes
					}
				}
				FROM = {
					GER_remove_mefo_bills = yes
					set_country_flag = mefo_bills_removed_through_war
				}
			}
			#Remove previous ideology civil war faction from Democratic Germany faction and add Democratic civil war faction to Germany's faction
			if = {
				limit = {
					FROM = {
						is_in_faction_with = GER
						#	has_civil_war = yes
						NOT = {
							has_government = democratic
						}
					}
					has_government = democratic
					GER = {
						has_government = democratic
					}
				}
				FROM = {
					set_country_flag = GER_civil_war_target
				}
				GER = {
					remove_from_faction = FROM
				}
				GER = {
					add_to_faction = ROOT
				}
				GER = {
					country_event = wtt_germany.52
				}
			}
			#If prepared by siphoning equipment, receive equipment back
			if = {
				limit = {
					FROM = {
						has_civil_war = yes
						has_country_flag = siphoned_equipment_stockpiles_for_civil_war
					}
					has_civil_war = yes
				}
				FROM = {
					clr_country_flag = siphoned_equipment_stockpiles_for_civil_war
					add_equipment_to_stockpile = {
						type = infantry_equipment
						amount = 1000
					}
				}
			}
			#If prepared with surprise attack plan, get bonus
			if = {
				limit = {
					FROM = {
						has_civil_war = yes
						original_tag = SPR
					}
					has_civil_war = yes
					original_tag = SPR
				}
				random_country = {
					limit = {
						original_tag = FRA
						OR = {
							has_completed_focus = FRA_the_path_of_avenger
						}
					}
					country_event = {
						id = france.32
					}
				}
			}
		}
	}
	# ROOT is capitulated country, FROM is winner
	on_capitulation = {
		effect = {
			if = {
				limit = {
					original_tag = GER
					has_government = fascism
					is_subject = no
					NOT = {
						has_global_flag = downfall_of_ger
					}
				}
				set_global_flag = downfall_of_ger
				if = {
					limit = {
						country_exists = QDA
					}
					annex_country = {
						target = QDA
					}
					every_state = {
						limit = {
							is_core_of = QDA
						}
						remove_core_of = QDA
					}
				}
				if = {
					limit = {
						country_exists = RKP
						country_exists = POL
						POL = {
							is_subject = no
						}
						POL = {
							has_war_with = GER
						}
						NOT = {
							POL = {
								is_in_faction_with = GER
							}
						}
					}
					POL = {
						annex_country = {
							target = RKP
						}
					}
					every_state = {
						limit = {
							is_core_of = RKP
						}
						remove_core_of = RKP
					}
				}
				else = {
					GER = {
						annex_country = {
							target = RKP
						}
					}
					every_state = {
						limit = {
							is_core_of = RKP
						}
						remove_core_of = RKP
					}
				}
				if = {
					limit = {
						country_exists = RKO
					}
					annex_country = {
						target = RKO
					}
					every_state = {
						limit = {
							is_core_of = RKO
						}
						remove_core_of = RKO
					}
				}
				if = {
					limit = {
						country_exists = RKU
						country_exists = SOV
						SOV = {
							is_subject = no
						}
						SOV = {
							has_war_with = GER
						}
						NOT = {
							SOV = {
								is_in_faction_with = GER
							}
						}
					}
					SOV = {
						annex_country = {
							target = RKU
						}
					}
					every_state = {
						limit = {
							is_core_of = RKU
						}
						remove_core_of = RKU
					}
				}
				else_if = {
					limit = {
						country_exists = RUS
						RUS = {
							is_subject = no
						}
						RUS = {
							has_war_with = GER
						}
						NOT = {
							RUS = {
								is_in_faction_with = GER
							}
						}
					}
					RUS = {
						annex_country = {
							target = RKU
						}
					}
					every_state = {
						limit = {
							is_core_of = RKU
						}
						remove_core_of = RKU
					}
				}
				else = {
					GER = {
						annex_country = {
							target = RKU
						}
					}
					every_state = {
						limit = {
							is_core_of = RKU
						}
						remove_core_of = RKU
					}
				}
				if = {
					limit = {
						country_exists = RKR
						country_exists = SOV
						SOV = {
							is_subject = no
						}
						SOV = {
							has_war_with = GER
						}
						NOT = {
							SOV = {
								is_in_faction_with = GER
							}
						}
					}
					SOV = {
						annex_country = {
							target = RKR
						}
					}
					every_state = {
						limit = {
							is_core_of = RKR
						}
						remove_core_of = RKR
					}
				}
				else_if = {
					limit = {
						country_exists = RUS
						RUS = {
							is_subject = no
						}
						RUS = {
							has_war_with = GER
						}
						NOT = {
							RUS = {
								is_in_faction_with = GER
							}
						}
					}
					RUS = {
						annex_country = {
							target = RKR
						}
					}
					every_state = {
						limit = {
							is_core_of = RKR
						}
						remove_core_of = RKR
					}
				}
				else = {
					GER = {
						annex_country = {
							target = RKR
						}
					}
					every_state = {
						limit = {
							is_core_of = RKR
						}
						remove_core_of = RKR
					}
				}
				if = {
					limit = {
						country_exists = RKM
						country_exists = SOV
						SOV = {
							is_subject = no
						}
						SOV = {
							has_war_with = GER
						}
						NOT = {
							SOV = {
								is_in_faction_with = GER
							}
						}
					}
					SOV = {
						annex_country = {
							target = RKM
						}
					}
					every_state = {
						limit = {
							is_core_of = RKM
						}
						remove_core_of = RKM
					}
				}
				else_if = {
					limit = {
						country_exists = RUS
						RUS = {
							is_subject = no
						}
						RUS = {
							has_war_with = GER
						}
						NOT = {
							RUS = {
								is_in_faction_with = GER
							}
						}
					}
					RUS = {
						annex_country = {
							target = RKM
						}
					}
					every_state = {
						limit = {
							is_core_of = RKM
						}
						remove_core_of = RKM
					}
				}
				else = {
					GER = {
						annex_country = {
							target = RKM
						}
					}
					every_state = {
						limit = {
							is_core_of = RKM
						}
						remove_core_of = RKM
					}
				}
				if = {
					limit = {
						country_exists = RKA
						country_exists = SOV
						SOV = {
							is_subject = no
						}
						SOV = {
							has_war_with = GER
						}
						NOT = {
							SOV = {
								is_in_faction_with = GER
							}
						}
					}
					SOV = {
						annex_country = {
							target = RKA
						}
					}
					every_state = {
						limit = {
							is_core_of = RKA
						}
						remove_core_of = RKA
					}
				}
				else_if = {
					limit = {
						country_exists = RUS
						RUS = {
							is_subject = no
						}
						RUS = {
							has_war_with = GER
						}
						NOT = {
							RUS = {
								is_in_faction_with = GER
							}
						}
					}
					RUS = {
						annex_country = {
							target = RKA
						}
					}
					every_state = {
						limit = {
							is_core_of = RKA
						}
						remove_core_of = RKA
					}
				}
				else = {
					GER = {
						annex_country = {
							target = RKA
						}
					}
					every_state = {
						limit = {
							is_core_of = RKA
						}
						remove_core_of = RKA
					}
				}
				if = {
					limit = {
						country_exists = RUL
					}
					annex_country = {
						target = RUL
					}
					every_state = {
						limit = {
							is_core_of = RUL
						}
						remove_core_of = RUL
					}
				}
				if = {
					limit = {
						country_exists = RTK
					}
					annex_country = {
						target = RTK
					}
					every_state = {
						limit = {
							is_core_of = RTK
						}
						remove_core_of = RTK
					}
				}
				if = {
					limit = {
						country_exists = RKC
						country_exists = CZE
						CZE = {
							is_subject = no
						}
						CZE = {
							has_war_with = GER
						}
						NOT = {
							CZE = {
								is_in_faction_with = GER
							}
						}
					}
					CZE = {
						annex_country = {
							target = RKC
						}
					}
					every_state = {
						limit = {
							is_core_of = RKC
						}
						remove_core_of = RKC
					}
				}
				else = {
					GER = {
						annex_country = {
							target = RKC
						}
					}
					every_state = {
						limit = {
							is_core_of = RKC
						}
						remove_core_of = RKC
					}
				}
				if = {
					limit = {
						country_exists = RKH
						country_exists = HUN
						HUN = {
							is_subject = no
						}
						HUN = {
							has_war_with = GER
						}
						NOT = {
							HUN = {
								is_in_faction_with = GER
							}
						}
					}
					HUN = {
						annex_country = {
							target = RKH
						}
					}
					every_state = {
						limit = {
							is_core_of = RKH
						}
						remove_core_of = RKH
					}
				}
				else = {
					GER = {
						annex_country = {
							target = RKH
						}
					}
					every_state = {
						limit = {
							is_core_of = RKH
						}
						remove_core_of = RKH
					}
				}
				if = {
					limit = {
						country_exists = RKF
						country_exists = FRA
						FRA = {
							is_subject = no
						}
						FRA = {
							has_war_with = GER
						}
						NOT = {
							FRA = {
								is_in_faction_with = GER
							}
						}
					}
					FRA = {
						annex_country = {
							target = RKF
						}
					}
					every_state = {
						limit = {
							is_core_of = RKF
						}
						remove_core_of = RKF
					}
				}
				else = {
					GER = {
						annex_country = {
							target = RKF
						}
					}
					every_state = {
						limit = {
							is_core_of = RKF
						}
						remove_core_of = RKF
					}
				}
				if = {
					limit = {
						country_exists = RKI
						country_exists = ITA
						ITA = {
							is_subject = no
						}
						ITA = {
							has_war_with = GER
						}
						NOT = {
							ITA = {
								is_in_faction_with = GER
							}
						}
					}
					ITA = {
						annex_country = {
							target = RKI
						}
					}
					every_state = {
						limit = {
							is_core_of = RKI
						}
						remove_core_of = RKI
					}
				}
				else = {
					GER = {
						annex_country = {
							target = RKI
						}
					}
					every_state = {
						limit = {
							is_core_of = RKI
						}
						remove_core_of = RKI
					}
				}
				if = {
					limit = {
						country_exists = RKE
						country_exists = ENG
						ENG = {
							is_subject = no
						}
						ENG = {
							has_war_with = GER
						}
						NOT = {
							ENG = {
								is_in_faction_with = GER
							}
						}
					}
					ENG = {
						annex_country = {
							target = RKE
						}
					}
					every_state = {
						limit = {
							is_core_of = RKE
						}
						remove_core_of = RKE
					}
				}
				else = {
					GER = {
						annex_country = {
							target = RKE
						}
					}
					every_state = {
						limit = {
							is_core_of = RKE
						}
						remove_core_of = RKE
					}
				}
				if = {
					limit = {
						country_exists = RKN
						country_exists = SWE
						SWE = {
							is_subject = no
						}
						SWE = {
							has_war_with = GER
						}
						NOT = {
							SWE = {
								is_in_faction_with = GER
							}
						}
					}
					SWE = {
						annex_country = {
							target = RKN
						}
					}
					every_state = {
						limit = {
							is_core_of = RKN
						}
						remove_core_of = RKN
					}
				}
				else = {
					GER = {
						annex_country = {
							target = RKN
						}
					}
					every_state = {
						limit = {
							is_core_of = RKN
						}
						remove_core_of = RKN
					}
				}
				if = {
					limit = {
						country_exists = RIB
					}
					annex_country = {
						target = RIB
					}
					every_state = {
						limit = {
							is_core_of = RIB
						}
						remove_core_of = RIB
					}
				}
			}
			if = {
				limit = {
					tag = GER
					FROM = {
						tag = SOV
					}
					NOT = {
						has_global_flag = fall_of_berlin_sov
					}
				}
				play_victory_parade_effect = yes
			}
			if = {
				limit = {
					NOT = {
						original_tag = GER
					}
					NOT = {
						has_government = fascism
					}
					has_civil_war = no
					NOT = {
						AND = {
							FROM = {
								original_tag = SPR
							}
							original_tag = SPR
						}
					}
				}
				news_event = {
					id = country_capitulated.0
					days = 0
				}
			}
			if = {
				limit = {
					tag = FRA
				}
				set_global_flag = FRA_already_surrendered
				set_variable = {
					global.FRA_capitulation_days = global.num_days
				}
			}
			if = {
				limit = {
					FROM = {
						tag = JAP
					}
					ROOT = {
						tag = CHI
					}
				}
				JAP = {
					JAP_intervene_in_china_remove = yes
				}
			}
			if = {
				limit = {
					original_tag = POL
					has_government = neutrality
				}
				retire_country_leader = yes
			}
			if = {
				limit = {
					original_tag = YUG
				}
				remove_ideas = YUG_idea_economic_aid
			}
			if = {
				limit = {
					original_tag = DEN
				}
				country_event = {
					id = wtt_denmark.1
					days = 1
				}
			}
			if = {
				limit = {
					original_tag = FRA
					has_government = democratic
					NOT = {
						has_global_flag = achievement_france_surrender
					}
					#might as well use the achievement flag to check if france.10 fired
					is_subject = no
					is_in_faction_with = ENG
					has_war_with = GER
				}
				country_event = france.10
			}
		}
	}
	# ROOT is previously capitulated country
	on_uncapitulation = {
		effect = {
			if = {
				limit = {
					original_tag = FRA
					has_government = democratic
					is_puppet = no
				}
				drop_cosmetic_tag = yes
			}
		}
	}
	#ROOT = country that joined a war
	on_war = {
		effect = {
			if = {
				limit = {
					tag = USA
					has_war_with = JAP
					NOT = {
						has_global_flag = day_of_infamy_happened
					}
					has_country_leader = {
						name = "Franklin Delano Roosevelt"
						ruling_only = yes
					}
				}
				play_day_of_infamy_effect = yes
			}
			if = {
				limit = {
					tag = ENG
					has_war_with = GER
					has_country_leader = {
						name = "Neville Chamberlain"
						ruling_only = yes
					}
				}
				play_war_with_germany_effect = yes
			}
		}
	}
	on_war_relation_added = {
		effect = {
			if = {
				limit = {
					tag = GER
					FROM = {
						tag = SOV
						has_government = communism
					}
				}
				set_global_flag = {
					flag = barbarossa_counter
					value = 1
					days = 60
				}
			}
		}
	}
}
