POR_overseas_provinces = {
	POR_angola_overseas_province = {
		icon = infiltrate_state
		available = {
			has_completed_focus = POR_luso_tropicalism
			POR = {
				controls_state = 914
				controls_state = 916
				controls_state = 540
				controls_state = 917
				controls_state = 959
				controls_state = 54
			}
			ANG = {
				exists = no
			}
		}
		cost = 0
		fire_only_once = yes
		days_remove = 730
		ai_will_do = {
			factor = 2
		}
		modifier = {
			political_power_gain = -0.2
		}
		visible = {
			has_completed_focus = POR_luso_tropicalism
		}
		remove_effect = {
			country_event = lar_portugal_overseas_provinces.1
		}
	}
	POR_mozambique_overseas_territory = {
		icon = infiltrate_state
		available = {
			has_completed_focus = POR_luso_tropicalism
			AND = {
				POR = {
					controls_state = 544
					controls_state = 950
					controls_state = 954
				}
				MZB = {
					exists = no
				}
			}
		}
		cost = 0
		fire_only_once = yes
		days_remove = 730
		ai_will_do = {
			factor = 2
		}
		modifier = {
			political_power_gain = -0.2
		}
		visible = {
			has_completed_focus = POR_luso_tropicalism
		}
		remove_effect = {
			country_event = lar_portugal_overseas_provinces.2
		}
	}
}

POR_arms_purchases = {
	POR_buy_ships_britain = {
		icon = eng_trade_unions_support
		available = {
			ENG = {
				has_war = no
				has_opinion = {
					target = ROOT
					value > 0
				}
			}
		}
		cost = 0
		ai_will_do = {
			base = 10
			modifier = {
				factor = 5
				ENG = {
					has_government = ROOT
				}
				NOT = {
					has_government = fascism
				}
			}
			modifier = {
				factor = 0
				has_country_flag = POR_ships_purchase_timer
			}
			modifier = {
				factor = 0
				has_government = fascism
				ENG = {
					NOT = {
						has_government = fascism
					}
				}
			}
		}
		visible = {
			has_completed_focus = POR_second_navy_reequipment
			ENG = {
				exists = yes
				NOT = {
					has_war_with = ROOT
				}
				has_civil_war = no
				has_capitulated = no
				owns_state = 126				#Owns London
			}
			NOT = {
				has_country_flag = POR_ships_purchase_in_progress_flag
			}
			NOT = {
				has_country_flag = POR_british_ships_purchase_rejected_flag
			}
		}
		complete_effect = {
			ENG = {
				country_event = {
					id = lar_portugal_purchase_ships.1
				}
			}
			set_country_flag = POR_ships_purchase_in_progress_flag
			set_country_flag = {
				flag = POR_ships_purchase_timer
				days = 180
				value = 1
			}
		}
	}
	POR_buy_ships_italy = {
		icon = eng_trade_unions_support
		available = {
			ITA = {
				has_war = no
				has_opinion = {
					target = ROOT
					value > 0
				}
			}
		}
		cost = 0
		ai_will_do = {
			base = 10
			modifier = {
				factor = 5
				ITA = {
					has_government = ROOT
				}
			}
			modifier = {
				factor = 0
				has_country_flag = POR_ships_purchase_timer
			}
		}
		visible = {
			has_completed_focus = POR_second_navy_reequipment
			ITA = {
				exists = yes
				NOT = {
					has_war_with = ROOT
				}
				has_civil_war = no
				has_capitulated = no
				owns_state = 2				#Owns Rome
			}
			NOT = {
				has_country_flag = POR_ships_purchase_in_progress_flag
			}
			NOT = {
				has_country_flag = POR_british_ships_purchase_rejected_flag
			}
		}
		complete_effect = {
			ITA = {
				country_event = {
					id = lar_portugal_purchase_ships.1
				}
			}
			set_country_flag = POR_ships_purchase_in_progress_flag
			set_country_flag = {
				flag = POR_ships_purchase_timer
				days = 180
				value = 1
			}
		}
	}
	#Mission to track the progress of British SUBMARINES construction
	POR_british_submarines_construction_progress = {
		icon = generic_naval
		allowed = {
			original_tag = POR
		}
		visible = {
			has_country_flag = POR_purchase_british_submarines_flag
		}
		modifier = {
			civilian_factory_use = 1
		}
		days_remove = 365
		cancel_trigger = {
			OR = {
				NOT = {
					country_exists = POR
				}
				NOT = {
					country_exists = ENG
				}
				ENG = {
					OR = {
						has_war_with = ROOT
						has_civil_war = yes
						has_capitulated = yes
						NOT = {
							owns_state = 126
						}						#Owns London
					}
				}
			}
		}
		#On Activation
		complete_effect = {
			ENG = {
				add_offsite_building = {
					type = industrial_complex
					level = 1
				}
			}
		}
		#Fail
		cancel_effect = {
			ENG = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
				remove_opinion_modifier = {
					target = POR
					modifier = POR_bought_ships
				}
			}
			remove_opinion_modifier = {
				target = ENG
				modifier = POR_sold_ships
			}
			remove_opinion_modifier = {
				target = ENG
				modifier = POR_ships_trade
			}
			clr_country_flag = POR_purchase_british_submarines_flag
			clr_country_flag = POR_ships_purchase_in_progress_flag
		}
		#Success
		remove_effect = {
			hidden_effect = {
				add_manpower = 600
			}
			if = {
				limit = {
					has_dlc = "Man the Guns"
				}
				if = {
					limit = {
						ENG = {
							has_tech = advanced_ship_hull_submarine
						}
					}
					ENG = {
						create_equipment_variant = {
							name = "Delfim Class"
							type = ship_hull_submarine_4
							name_group = POR_SS_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_torpedo_slot = ship_torpedo_sub_1
								fixed_ship_engine_slot = sub_ship_engine_1
								rear_1_custom_slot = ship_torpedo_sub_1
								front_1_custom_slot = ship_torpedo_sub_1
							}
						}
					}
					create_ship = {
						type = ship_hull_submarine_4
						equipment_variant = "Delfim Class"
						creator = ENG
					}
					create_ship = {
						type = ship_hull_submarine_4
						equipment_variant = "Delfim Class"
						creator = ENG
					}
					create_ship = {
						type = ship_hull_submarine_4
						equipment_variant = "Delfim Class"
						creator = ENG
					}
				}
				else_if = {
					limit = {
						ENG = {
							has_tech = improved_ship_hull_submarine
						}
					}
					ENG = {
						create_equipment_variant = {
							name = "Delfim Class"
							type = ship_hull_submarine_3
							name_group = POR_SS_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_torpedo_slot = ship_torpedo_sub_1
								fixed_ship_engine_slot = sub_ship_engine_1
								rear_1_custom_slot = ship_torpedo_sub_1
							}
						}
					}
					create_ship = {
						type = ship_hull_submarine_3
						equipment_variant = "Delfim Class"
						creator = ENG
					}
					create_ship = {
						type = ship_hull_submarine_3
						equipment_variant = "Delfim Class"
						creator = ENG
					}
					create_ship = {
						type = ship_hull_submarine_3
						equipment_variant = "Delfim Class"
						creator = ENG
					}
				}
				else = {
					create_ship = {
						type = ship_hull_submarine_2
						equipment_variant = "Delfim Class"
						creator = POR
					}
					create_ship = {
						type = ship_hull_submarine_2
						equipment_variant = "Delfim Class"
						creator = POR
					}
					create_ship = {
						type = ship_hull_submarine_2
						equipment_variant = "Delfim Class"
						creator = POR
					}
				}
			}
			ENG = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
			}
			country_event = lar_portugal_purchase_ships.4
			set_country_flag = POR_ships_purchased_flag
			clr_country_flag = POR_purchase_british_submarines_flag
			clr_country_flag = POR_ships_purchase_in_progress_flag
		}
	}
	#Mission to track the progress of Italian SUBMARINES construction
	POR_italian_submarines_construction_progress = {
		icon = generic_naval
		allowed = {
			original_tag = POR
		}
		visible = {
			has_country_flag = POR_purchase_italian_submarines_flag
		}
		modifier = {
			civilian_factory_use = 1
		}
		days_remove = 365
		cancel_trigger = {
			OR = {
				NOT = {
					country_exists = POR
				}
				NOT = {
					country_exists = ITA
				}
				ITA = {
					OR = {
						has_war_with = ROOT
						has_civil_war = yes
						has_capitulated = yes
						NOT = {
							owns_state = 2
						}						#Owns Rome
					}
				}
			}
		}
		#On Activation
		complete_effect = {
			ITA = {
				add_offsite_building = {
					type = industrial_complex
					level = 1
				}
			}
		}
		#Fail
		cancel_effect = {
			ITA = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
				remove_opinion_modifier = {
					target = POR
					modifier = POR_bought_ships
				}
			}
			remove_opinion_modifier = {
				target = ITA
				modifier = POR_sold_ships
			}
			remove_opinion_modifier = {
				target = ITA
				modifier = POR_ships_trade
			}
			clr_country_flag = POR_purchase_italian_submarines_flag
			clr_country_flag = POR_ships_purchase_in_progress_flag
		}
		#Success
		remove_effect = {
			hidden_effect = {
				add_manpower = 600
			}
			if = {
				limit = {
					has_dlc = "Man the Guns"
				}
				if = {
					limit = {
						ITA = {
							has_tech = advanced_ship_hull_submarine
						}
					}
					ITA = {
						create_equipment_variant = {
							name = "Delfim Class"
							type = ship_hull_submarine_4
							name_group = POR_SS_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_torpedo_slot = ship_torpedo_sub_1
								fixed_ship_engine_slot = sub_ship_engine_1
								rear_1_custom_slot = ship_torpedo_sub_1
								front_1_custom_slot = ship_torpedo_sub_1
							}
						}
					}
					create_ship = {
						type = ship_hull_submarine_4
						equipment_variant = "Delfim Class"
						creator = ITA
					}
					create_ship = {
						type = ship_hull_submarine_4
						equipment_variant = "Delfim Class"
						creator = ITA
					}
					create_ship = {
						type = ship_hull_submarine_4
						equipment_variant = "Delfim Class"
						creator = ITA
					}
				}
				else_if = {
					limit = {
						ITA = {
							has_tech = improved_ship_hull_submarine
						}
					}
					ITA = {
						create_equipment_variant = {
							name = "Delfim Class"
							type = ship_hull_submarine_3
							name_group = POR_SS_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_torpedo_slot = ship_torpedo_sub_1
								fixed_ship_engine_slot = sub_ship_engine_1
								rear_1_custom_slot = ship_torpedo_sub_1
							}
						}
					}
					create_ship = {
						type = ship_hull_submarine_3
						equipment_variant = "Delfim Class"
						creator = ITA
					}
					create_ship = {
						type = ship_hull_submarine_3
						equipment_variant = "Delfim Class"
						creator = ITA
					}
					create_ship = {
						type = ship_hull_submarine_3
						equipment_variant = "Delfim Class"
						creator = ITA
					}
				}
				else = {
					create_ship = {
						type = ship_hull_submarine_2
						equipment_variant = "Delfim Class"
						creator = POR
					}
					create_ship = {
						type = ship_hull_submarine_2
						equipment_variant = "Delfim Class"
						creator = POR
					}
					create_ship = {
						type = ship_hull_submarine_2
						equipment_variant = "Delfim Class"
						creator = POR
					}
				}
			}
			ITA = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
			}
			country_event = lar_portugal_purchase_ships.4
			set_country_flag = POR_ships_purchased_flag
			clr_country_flag = POR_purchase_italian_submarines_flag
			clr_country_flag = POR_ships_purchase_in_progress_flag
		}
	}
	#Mission to track the progress of British DESTROYERS construction
	POR_british_destroyers_construction_progress = {
		icon = generic_naval
		allowed = {
			original_tag = POR
		}
		visible = {
			has_country_flag = POR_purchase_british_destroyers_flag
		}
		modifier = {
			civilian_factory_use = 1
		}
		days_remove = 365
		cancel_trigger = {
			OR = {
				NOT = {
					country_exists = POR
				}
				NOT = {
					country_exists = ENG
				}
				ENG = {
					OR = {
						has_war_with = ROOT
						has_civil_war = yes
						has_capitulated = yes
						NOT = {
							owns_state = 126
						}						#Owns London
					}
				}
			}
		}
		#On Activation
		complete_effect = {
			ENG = {
				add_offsite_building = {
					type = industrial_complex
					level = 1
				}
			}
		}
		#Fail
		cancel_effect = {
			ENG = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
				remove_opinion_modifier = {
					target = POR
					modifier = POR_bought_ships
				}
			}
			remove_opinion_modifier = {
				target = ENG
				modifier = POR_sold_ships
			}
			remove_opinion_modifier = {
				target = ENG
				modifier = POR_ships_trade
			}
			clr_country_flag = POR_purchase_british_destroyers_flag
			clr_country_flag = POR_ships_purchase_in_progress_flag
		}
		#Success
		remove_effect = {
			if = {
				limit = {
					has_dlc = "Man the Guns"
				}
				if = {
					limit = {
						ENG = {
							has_tech = advanced_ship_hull_light
						}
					}
					hidden_effect = {
						add_manpower = 1000
					}
					ENG = {
						create_equipment_variant = {
							name = "Vouga Class"
							type = ship_hull_light_4
							name_group = POR_DD_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_battery_slot = ship_light_battery_1
								fixed_ship_anti_air_slot = ship_anti_air_1
								fixed_ship_fire_control_system_slot = ship_fire_control_system_0
								fixed_ship_radar_slot = empty
								fixed_ship_engine_slot = light_ship_engine_2
								fixed_ship_torpedo_slot = ship_torpedo_1
								mid_1_custom_slot = ship_mine_layer_1
								rear_1_custom_slot = ship_depth_charge_1
							}
						}
					}
					create_ship = {
						type = ship_hull_light_4
						equipment_variant = "Vouga Class"
						creator = ENG
					}
					create_ship = {
						type = ship_hull_light_4
						equipment_variant = "Vouga Class"
						creator = ENG
					}
				}
				else_if = {
					limit = {
						ENG = {
							has_tech = improved_ship_hull_light
						}
					}
					hidden_effect = {
						add_manpower = 800
					}
					ENG = {
						create_equipment_variant = {
							name = "Vouga Class"
							type = ship_hull_light_3
							name_group = POR_DD_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_battery_slot = ship_light_battery_1
								fixed_ship_anti_air_slot = ship_anti_air_1
								fixed_ship_fire_control_system_slot = ship_fire_control_system_0
								fixed_ship_radar_slot = empty
								fixed_ship_engine_slot = light_ship_engine_2
								fixed_ship_torpedo_slot = ship_torpedo_1
								mid_1_custom_slot = ship_mine_layer_1
								rear_1_custom_slot = ship_depth_charge_1
							}
						}
					}
					create_ship = {
						type = ship_hull_light_3
						equipment_variant = "Vouga Class"
						creator = ENG
					}
					create_ship = {
						type = ship_hull_light_3
						equipment_variant = "Vouga Class"
						creator = ENG
					}
				}
				else = {
					hidden_effect = {
						add_manpower = 650
					}
					ENG = {
						create_equipment_variant = {
							name = "Vouga Class"
							type = ship_hull_light_2
							name_group = POR_DD_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_battery_slot = ship_light_battery_1
								fixed_ship_anti_air_slot = ship_anti_air_1
								fixed_ship_fire_control_system_slot = ship_fire_control_system_0
								fixed_ship_radar_slot = empty
								fixed_ship_engine_slot = light_ship_engine_2
								fixed_ship_torpedo_slot = ship_torpedo_1
								mid_1_custom_slot = ship_mine_layer_1
								rear_1_custom_slot = ship_depth_charge_1
							}
						}
					}
					create_ship = {
						type = ship_hull_light_2
						equipment_variant = "Vouga Class"
						creator = ENG
					}
					create_ship = {
						type = ship_hull_light_2
						equipment_variant = "Vouga Class"
						creator = ENG
					}
				}
			}
			ENG = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
			}
			country_event = lar_portugal_purchase_ships.5
			set_country_flag = POR_ships_purchased_flag
			clr_country_flag = POR_purchase_british_destroyers_flag
			clr_country_flag = POR_ships_purchase_in_progress_flag
		}
	}
	#Mission to track the progress of Italian DESTROYERS construction
	POR_italian_destroyers_construction_progress = {
		icon = generic_naval
		allowed = {
			original_tag = POR
		}
		visible = {
			has_country_flag = POR_purchase_italian_destroyers_flag
		}
		modifier = {
			civilian_factory_use = 1
		}
		days_remove = 365
		cancel_trigger = {
			OR = {
				NOT = {
					country_exists = POR
				}
				NOT = {
					country_exists = ITA
				}
				ITA = {
					OR = {
						has_war_with = ROOT
						has_civil_war = yes
						has_capitulated = yes
						NOT = {
							owns_state = 2
						}						#Owns Rome
					}
				}
			}
		}
		#On Activation
		complete_effect = {
			ITA = {
				add_offsite_building = {
					type = industrial_complex
					level = 1
				}
			}
		}
		#Fail
		cancel_effect = {
			ITA = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
				remove_opinion_modifier = {
					target = POR
					modifier = POR_bought_ships
				}
			}
			remove_opinion_modifier = {
				target = ITA
				modifier = POR_sold_ships
			}
			remove_opinion_modifier = {
				target = ITA
				modifier = POR_ships_trade
			}
			clr_country_flag = POR_purchase_italian_destroyers_flag
			clr_country_flag = POR_ships_purchase_in_progress_flag
		}
		#Success
		remove_effect = {
			if = {
				limit = {
					has_dlc = "Man the Guns"
				}
				if = {
					limit = {
						ITA = {
							has_tech = advanced_ship_hull_light
						}
					}
					hidden_effect = {
						add_manpower = 1000
					}
					ITA = {
						create_equipment_variant = {
							name = "Vouga Class"
							type = ship_hull_light_4
							name_group = POR_DD_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_battery_slot = ship_light_battery_1
								fixed_ship_anti_air_slot = ship_anti_air_1
								fixed_ship_fire_control_system_slot = ship_fire_control_system_0
								fixed_ship_radar_slot = empty
								fixed_ship_engine_slot = light_ship_engine_2
								fixed_ship_torpedo_slot = ship_torpedo_1
								mid_1_custom_slot = ship_mine_layer_1
								rear_1_custom_slot = ship_depth_charge_1
							}
						}
					}
					create_ship = {
						type = ship_hull_light_4
						equipment_variant = "Vouga Class"
						creator = ITA
					}
					create_ship = {
						type = ship_hull_light_4
						equipment_variant = "Vouga Class"
						creator = ITA
					}
				}
				else_if = {
					limit = {
						ITA = {
							has_tech = improved_ship_hull_light
						}
					}
					hidden_effect = {
						add_manpower = 800
					}
					ITA = {
						create_equipment_variant = {
							name = "Vouga Class"
							type = ship_hull_light_3
							name_group = POR_DD_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_battery_slot = ship_light_battery_1
								fixed_ship_anti_air_slot = ship_anti_air_1
								fixed_ship_fire_control_system_slot = ship_fire_control_system_0
								fixed_ship_radar_slot = empty
								fixed_ship_engine_slot = light_ship_engine_2
								fixed_ship_torpedo_slot = ship_torpedo_1
								mid_1_custom_slot = ship_mine_layer_1
								rear_1_custom_slot = ship_depth_charge_1
							}
						}
					}
					create_ship = {
						type = ship_hull_light_3
						equipment_variant = "Vouga Class"
						creator = ITA
					}
					create_ship = {
						type = ship_hull_light_3
						equipment_variant = "Vouga Class"
						creator = ITA
					}
				}
				else = {
					hidden_effect = {
						add_manpower = 650
					}
					ITA = {
						create_equipment_variant = {
							name = "Vouga Class"
							type = ship_hull_light_2
							name_group = POR_DD_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_battery_slot = ship_light_battery_1
								fixed_ship_anti_air_slot = ship_anti_air_1
								fixed_ship_fire_control_system_slot = ship_fire_control_system_0
								fixed_ship_radar_slot = empty
								fixed_ship_engine_slot = light_ship_engine_2
								fixed_ship_torpedo_slot = ship_torpedo_1
								mid_1_custom_slot = ship_mine_layer_1
								rear_1_custom_slot = ship_depth_charge_1
							}
						}
					}
					create_ship = {
						type = ship_hull_light_2
						equipment_variant = "Vouga Class"
						creator = ITA
					}
					create_ship = {
						type = ship_hull_light_2
						equipment_variant = "Vouga Class"
						creator = ITA
					}
				}
			}
			ITA = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
			}
			country_event = lar_portugal_purchase_ships.5
			set_country_flag = POR_ships_purchased_flag
			clr_country_flag = POR_purchase_italian_destroyers_flag
			clr_country_flag = POR_ships_purchase_in_progress_flag
		}
	}
	#Mission to track the progress of British LIGHT CRUISER construction
	POR_british_light_cruiser_construction_progress = {
		icon = generic_naval
		allowed = {
			original_tag = POR
		}
		visible = {
			has_country_flag = POR_purchase_british_light_cruiser_flag
		}
		modifier = {
			civilian_factory_use = 1
		}
		days_remove = 546
		cancel_trigger = {
			OR = {
				NOT = {
					country_exists = POR
				}
				NOT = {
					country_exists = ENG
				}
				ENG = {
					OR = {
						has_war_with = ROOT
						has_civil_war = yes
						has_capitulated = yes
						NOT = {
							owns_state = 126
						}						#Owns London
					}
				}
			}
		}
		#Fail
		cancel_effect = {
			ENG = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
				remove_opinion_modifier = {
					target = POR
					modifier = POR_bought_ships
				}
			}
			remove_opinion_modifier = {
				target = ENG
				modifier = POR_sold_ships
			}
			remove_opinion_modifier = {
				target = ENG
				modifier = POR_ships_trade
			}
			clr_country_flag = POR_purchase_british_light_cruiser_flag
			clr_country_flag = POR_ships_purchase_in_progress_flag
		}
		#Success
		remove_effect = {
			if = {
				limit = {
					has_dlc = "Man the Guns"
				}
				if = {
					limit = {
						ENG = {
							has_tech = advanced_ship_hull_cruiser
						}
					}
					hidden_effect = {
						add_manpower = 1400
					}
					ENG = {
						create_equipment_variant = {
							name = "Atlântico Class"
							type = ship_hull_cruiser_4
							name_group = POR_CL_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_battery_slot = ship_light_medium_battery_2
								fixed_ship_anti_air_slot = ship_anti_air_2
								fixed_ship_fire_control_system_slot = ship_fire_control_system_0
								fixed_ship_radar_slot = empty
								fixed_ship_engine_slot = cruiser_ship_engine_2
								fixed_ship_armor_slot = empty
								front_1_custom_slot = ship_anti_air_1
								mid_1_custom_slot = ship_torpedo_1
								mid_2_custom_slot = ship_airplane_launcher_1
								rear_1_custom_slot = ship_light_medium_battery_2
							}
						}
					}
					create_ship = {
						type = ship_hull_cruiser_4
						equipment_variant = "Atlântico Class"
						creator = ENG
					}
				}
				else_if = {
					limit = {
						ENG = {
							has_tech = improved_ship_hull_cruiser
						}
					}
					hidden_effect = {
						add_manpower = 1200
					}
					ENG = {
						create_equipment_variant = {
							name = "Atlântico Class"
							type = ship_hull_cruiser_3
							name_group = POR_CL_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_battery_slot = ship_light_medium_battery_2
								fixed_ship_anti_air_slot = ship_anti_air_2
								fixed_ship_fire_control_system_slot = ship_fire_control_system_0
								fixed_ship_radar_slot = empty
								fixed_ship_engine_slot = cruiser_ship_engine_2
								fixed_ship_armor_slot = empty
								front_1_custom_slot = ship_anti_air_1
								mid_1_custom_slot = ship_torpedo_1
								mid_2_custom_slot = ship_airplane_launcher_1
								rear_1_custom_slot = ship_light_medium_battery_2
							}
						}
					}
					create_ship = {
						type = ship_hull_cruiser_3
						equipment_variant = "Atlântico Class"
						creator = ENG
					}
				}
				else = {
					hidden_effect = {
						add_manpower = 800
					}
					ENG = {
						create_equipment_variant = {
							name = "Atlântico Class"
							type = ship_hull_cruiser_2
							name_group = POR_CL_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_battery_slot = ship_light_medium_battery_2
								fixed_ship_anti_air_slot = ship_anti_air_2
								fixed_ship_fire_control_system_slot = ship_fire_control_system_0
								fixed_ship_radar_slot = empty
								fixed_ship_engine_slot = cruiser_ship_engine_2
								fixed_ship_armor_slot = empty
								front_1_custom_slot = ship_anti_air_1
								mid_1_custom_slot = ship_torpedo_1
								mid_2_custom_slot = ship_airplane_launcher_1
								rear_1_custom_slot = ship_light_medium_battery_2
							}
						}
					}
					create_ship = {
						type = ship_hull_cruiser_2
						equipment_variant = "Atlântico Class"
						creator = ENG
					}
				}
			}
			ENG = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
			}
			country_event = lar_portugal_purchase_ships.6
			set_country_flag = POR_ships_purchased_flag
			clr_country_flag = POR_purchase_british_light_cruiser_flag
			clr_country_flag = POR_ships_purchase_in_progress_flag
		}
	}
	#Mission to track the progress of Italian LIGHT CRUISER construction
	POR_italian_light_cruiser_construction_progress = {
		icon = generic_naval
		allowed = {
			original_tag = POR
		}
		visible = {
			has_country_flag = POR_purchase_italian_light_cruiser_flag
		}
		modifier = {
			civilian_factory_use = 1
		}
		days_remove = 546
		cancel_trigger = {
			OR = {
				NOT = {
					country_exists = POR
				}
				NOT = {
					country_exists = ITA
				}
				ITA = {
					OR = {
						has_war_with = ROOT
						has_civil_war = yes
						has_capitulated = yes
						NOT = {
							owns_state = 2
						}						#Owns Rome
					}
				}
			}
		}
		#On Activation
		complete_effect = {
			ITA = {
				add_offsite_building = {
					type = industrial_complex
					level = 1
				}
			}
		}
		#Fail
		cancel_effect = {
			ITA = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
				remove_opinion_modifier = {
					target = POR
					modifier = POR_bought_ships
				}
			}
			remove_opinion_modifier = {
				target = ITA
				modifier = POR_sold_ships
			}
			remove_opinion_modifier = {
				target = ITA
				modifier = POR_ships_trade
			}
			clr_country_flag = POR_purchase_italian_light_cruiser_flag
			clr_country_flag = POR_ships_purchase_in_progress_flag
		}
		#Success
		remove_effect = {
			if = {
				limit = {
					has_dlc = "Man the Guns"
				}
				if = {
					limit = {
						ITA = {
							has_tech = advanced_ship_hull_cruiser
						}
					}
					hidden_effect = {
						add_manpower = 1400
					}
					ITA = {
						create_equipment_variant = {
							name = "Atlântico Class"
							type = ship_hull_cruiser_4
							name_group = POR_CL_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_battery_slot = ship_light_medium_battery_2
								fixed_ship_anti_air_slot = ship_anti_air_2
								fixed_ship_fire_control_system_slot = ship_fire_control_system_0
								fixed_ship_radar_slot = empty
								fixed_ship_engine_slot = cruiser_ship_engine_2
								fixed_ship_armor_slot = empty
								front_1_custom_slot = ship_anti_air_1
								mid_1_custom_slot = ship_torpedo_1
								mid_2_custom_slot = ship_airplane_launcher_1
								rear_1_custom_slot = ship_light_medium_battery_2
							}
						}
					}
					create_ship = {
						type = ship_hull_cruiser_4
						equipment_variant = "Atlântico Class"
						creator = ITA
					}
				}
				else_if = {
					limit = {
						ITA = {
							has_tech = improved_ship_hull_cruiser
						}
					}
					hidden_effect = {
						add_manpower = 1200
					}
					ITA = {
						create_equipment_variant = {
							name = "Atlântico Class"
							type = ship_hull_cruiser_3
							name_group = POR_CL_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_battery_slot = ship_light_medium_battery_2
								fixed_ship_anti_air_slot = ship_anti_air_2
								fixed_ship_fire_control_system_slot = ship_fire_control_system_0
								fixed_ship_radar_slot = empty
								fixed_ship_engine_slot = cruiser_ship_engine_2
								fixed_ship_armor_slot = empty
								front_1_custom_slot = ship_anti_air_1
								mid_1_custom_slot = ship_torpedo_1
								mid_2_custom_slot = ship_airplane_launcher_1
								rear_1_custom_slot = ship_light_medium_battery_2
							}
						}
					}
					create_ship = {
						type = ship_hull_cruiser_3
						equipment_variant = "Atlântico Class"
						creator = ITA
					}
				}
				else = {
					hidden_effect = {
						add_manpower = 800
					}
					ITA = {
						create_equipment_variant = {
							name = "Atlântico Class"
							type = ship_hull_cruiser_2
							name_group = POR_CL_HISTORICAL
							parent_version = 0
							allow_without_tech = yes
							modules = {
								fixed_ship_battery_slot = ship_light_medium_battery_2
								fixed_ship_anti_air_slot = ship_anti_air_2
								fixed_ship_fire_control_system_slot = ship_fire_control_system_0
								fixed_ship_radar_slot = empty
								fixed_ship_engine_slot = cruiser_ship_engine_2
								fixed_ship_armor_slot = empty
								front_1_custom_slot = ship_anti_air_1
								mid_1_custom_slot = ship_torpedo_1
								mid_2_custom_slot = ship_airplane_launcher_1
								rear_1_custom_slot = ship_light_medium_battery_2
							}
						}
					}
					create_ship = {
						type = ship_hull_cruiser_2
						equipment_variant = "Atlântico Class"
						creator = ITA
					}
				}
			}
			ITA = {
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
			}
			country_event = lar_portugal_purchase_ships.6
			set_country_flag = POR_ships_purchased_flag
			clr_country_flag = POR_purchase_italian_light_cruiser_flag
			clr_country_flag = POR_ships_purchase_in_progress_flag
		}
	}
}

POR_naval_blockade = {
	POR_evade_blockade_with_portuguese_convoys = {
		icon = generic_naval
		allowed = {
			NOT = {
				original_tag = POR
			}
		}
		visible = {
			POR = {
				has_completed_focus = POR_refuse_the_naval_blockade
			}
			NOT = {
				has_country_flag = POR_evade_blockade_flag
				has_country_flag = POR_cancel_evade_blockade_flag
			}
		}
		available = {
			num_of_civilian_factories > 1
			POR = {
				has_navy_size = {
					size > 49
					type = convoy
				}
				has_opinion = {
					target = ROOT
					value > -10
				}
			}
		}
		cost = 25
		fire_only_once = yes
		ai_will_do = {
			base = 1
		}
		cancel_trigger = {
			OR = {
				NOT = {
					has_war_with = ENG
				}
				has_war_with = POR
				has_country_flag = POR_cancel_evade_blockade_flag
				has_capitulated = yes
			}
		}
		days_remove = -1
		modifier = {
			civilian_factory_use = 1
		}
		#Fail
		cancel_effect = {
			add_war_support = -0.1
			POR = {
				add_equipment_to_stockpile = {
					type = convoy_1
					amount = 50
				}
				add_offsite_building = {
					type = industrial_complex
					level = -1
				}
			}
			set_country_flag = POR_cancel_evade_blockade_flag
			clr_country_flag = POR_evade_blockade_flag
		}
		#On Activation
		complete_effect = {
			add_war_support = 0.1
			set_country_flag = POR_evade_blockade_flag
			effect_tooltip = {
				POR = {
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = -50
					}
					add_offsite_building = {
						type = industrial_complex
						level = 1
					}
				}
			}
			hidden_effect = {
				POR = {
					country_event = lar_portugal_naval_blockade.2
					activate_targeted_decision = {
						target = ROOT
						decision = POR_portugal_cancel_blockade_evasion_for_country
					}
				}
			}
		}
	}
	POR_major_cancel_portuguese_blockade_evasion = {
		icon = generic_break_treaty
		available = {
			has_country_flag = POR_evade_blockade_flag
		}
		cost = 0
		fire_only_once = yes
		ai_will_do = {
			base = 0
			modifier = {
				add = 1
				num_of_civilian_factories < 6
			}
		}
		visible = {
			has_country_flag = POR_evade_blockade_flag
			NOT = {
				has_country_flag = POR_cancel_evade_blockade_flag
			}
		}
		complete_effect = {
			add_war_support = -0.1
			set_country_flag = POR_cancel_evade_blockade_flag
			clr_country_flag = POR_evade_blockade_flag
		}
	}
	POR_portugal_cancel_blockade_evasion_for_country = {
		icon = generic_break_treaty
		available = {
			always = yes
		}
		cost = 0
		fire_only_once = yes
		ai_will_do = {
			base = 0
			modifier = {
				add = 1
				OR = {
					has_equipment = {
						convoy_1 < 5
					}
					AND = {
						has_opinion = {
							target = FROM
							value < -10
						}
						NOT = {
							has_war_with = FROM
						}
					}
				}
			}
		}
		visible = {
			original_tag = POR
			country_exists = FROM
			FROM = {
				has_country_flag = POR_evade_blockade_flag
				NOT = {
					has_country_flag = POR_cancel_evade_blockade_flag
					has_war_with = POR
				}
			}
		}
		complete_effect = {
			FROM = {
				add_war_support = -0.1
				set_country_flag = POR_cancel_evade_blockade_flag
				clr_country_flag = POR_evade_blockade_flag
			}
		}
	}
}

POR_prospect_for_resources = {
	POR_develop_lisbon_tungsten_deposits = {
		#112
		icon = tungsten
		allowed = {
		}
		highlight_states = {
			highlight_state_targets = {
				state = 112
			}
		}
		available = {
			has_completed_focus = POR_extraction_industries
			num_of_civilian_factories_available_for_projects > 2
			owns_state = 112
			controls_state = 112
		}
		visible = {
			owns_state = 112
			controls_state = 112
			112 = {
				NOT = {
					has_state_flag = POR_lisbon_tungsten_developed_flag
				}
			}
		}
		cost = 25
		days_remove = 90
		fire_only_once = yes
		modifier = {
			civilian_factory_use = 3
		}
		remove_effect = {
			112 = {
				set_state_flag = POR_lisbon_tungsten_developed_flag
			}
			112 = {
				add_resource = {
					type = tungsten
					amount = 10
				}
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				has_political_power < 200
				factor = 0
			}
		}
	}
	POR_develop_santarem_chromium_deposits = {
		#795
		icon = chromium
		allowed = {
		}
		highlight_states = {
			highlight_state_targets = {
				state = 795
			}
		}
		available = {
			has_completed_focus = POR_extraction_industries
			num_of_civilian_factories_available_for_projects > 1
			owns_state = 939
			controls_state = 939
		}
		visible = {
			owns_state = 939
			controls_state = 939
			939 = {
				NOT = {
					has_state_flag = {
						flag = POR_santarem_chromium_developed_flag
						value = 5
					}
				}
			}
		}
		cost = 25
		days_remove = POR_santarem_chromium_duration
		modifier = {
			civilian_factory_use = 1
		}
		remove_effect = {
			add_to_variable = {
				var = POR_santarem_chromium_duration
				value = 30
			}
			939 = {
				if = {
					limit = {
						NOT = {
							has_state_flag = POR_santarem_chromium_developed_flag
						}
					}
					set_state_flag = {
						flag = POR_santarem_chromium_developed_flag
						value = 1
					}
				}
				else = {
					modify_state_flag = {
						flag = POR_santarem_chromium_developed_flag
						value = 1
					}
				}
			}
			939 = {
				add_resource = {
					type = chromium
					amount = 2
				}
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				has_political_power < 200
				factor = 0
			}
		}
		complete_effect = {
			if = {
				limit = {
					check_variable = {
						var = POR_santarem_chromium_duration
						value = 30
						compare = less_than
					}
				}
				set_variable = {
					var = POR_santarem_chromium_duration
					value = 15
				}
			}
		}
	}
}

POR_the_spanish_civil_war = {
	POR_fight_alongside_the_nationalists = {
		icon = generic_prepare_civil_war
		available = {
			has_manpower > 10000
			has_stability > 0.5
			always = no
		}
		cost = 0
		fire_only_once = yes
		ai_will_do = {
			factor = 1
			modifier = {
				OR = {
					has_stability < 0.3
					has_manpower < 50000
				}
				factor = 0
			}
		}
		visible = {
			has_completed_focus = POR_send_assistance
		}
		complete_effect = {
		}
	}
}
